// @[./view/view_example_data.sx] (from:now()[-2 day], to:now(), app:'customer')
// @[./view/view_example_data.sx] (from:now()[-2 day], to:now())
@[./view/view_example_data.sx](from:now()[-3 day], to:now(), app:'customer')
| filter_out(accounts[authorized_apps] IS NULL)
| select(authorized_apps:VARIANT_ARRAY(accounts[authorized_apps]),*)
| select(UNNEST(authorized_apps))
| select(client_name:unnest[client_name],num_users:unnest[num_users])
| group(client_name)
| sort (num_users desc)